<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script>
      let datas = [];

      const showCountryInfo = (countryInfos) => {
        $("ul").empty();
        countryInfos.forEach((country) => {
          const li = `
              <li class="d-flex align-items-center border p-3 rounded shadow-sm">
                <img src="${country.flags.png}" alt="${country.flags.alt}" class="img-fluid rounded" />
                <p class="mb-0 ms-3">${country.name.common} (${country.name.official})</p>
              </li>
            `;
          $("ul").append(li);
        });
      };

      axios
        .get("https://restcountries.com/v3.1/all")
        .then((res) => {
          datas = [...res.data]; // deep copy
          showCountryInfo(datas);
        })
        .catch((err) => {
          console.log(err);
        });
    </script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <style>
      img {
        width: 100px;
        height: auto;
        margin-right: 10px;
      }
      /* p {
        display: inline;
      } */
      ul {
        padding: 0;
      }
      li {
        list-style-type: none;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container my-5">
      <h1 class="text-center text-primary mb-4">국가 정보를 가져와서 출력</h1>
      <div class="d-flex justify-content-center mb-4">
        <input
          type="text"
          class="form-control"
          placeholder="검색할 국가명을 입력하세요."
        />
      </div>
      <ul class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3"></ul>
    </div>

    <script>
      $("input").on("keyup", (e) => {
        const inputText = $(e.currentTarget).val().toLowerCase();
        console.log(inputText); // 현재 입력창에 입력한 내용

        const filteredData = datas.filter(
          (data) =>
            data.name.common.toLowerCase().indexOf(inputText) >= 0 ||
            data.name.official.toLowerCase().indexOf(inputText) >= 0
        );
        showCountryInfo(filteredData);
      });

//       TODO.
//        1. 검색 결과로 조회된 국가 개수를 출력하는 코드를 추가 
//        2. 국가명 아래에 구글 지도와 Open Street Map 지도를 보여주는 링크를 추가 
//        (링크를 클릭하면 지도가 새창에서 열리도록)

    </script>
  </body>
</html>
